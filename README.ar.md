shamela_books — تحويل كتب الشاملة إلى EPUB (اتجاه RTL)

أداة خفيفة لبناء ملفات EPUB3 متوافقة مع Kindle من موقع `shamela.ws`، مع الحفاظ على النص العربي واتجاه القراءة من اليمين إلى اليسار وبنية بسيطة.

## بنية المستودع
- `scripts/shamela_to_epub.py`: السكربت الرئيسي (بدون اعتماديات خارجية).
- `output/`: المخرجات (غير متتبَّعة في git).

## التنسيق المدعوم (واحد فقط)
- EPUB3 بملف تعريف «مصغَّر»:
  - بدون خطوط مضمّنة.
  - بدون صفحة غلاف أو «بطاقة الكتاب» داخل الملف.
  - ملف `nav.xhtml` موجود في manifest لكنه غير مضاف إلى spine.
  - فصول XHTML نظيفة مع CSS خارجي واتجاه RTL.

## طريقة الاستخدام
- تنزيل كتاب كامل: `python3 scripts/shamela_to_epub.py 'https://shamela.ws/book/158' --throttle 0.6`
- مع غلاف (بحث Google Images): أضف `--cover-auto`
- تجربة سريعة (أول N فصل): `--limit N`
- اسم الملف الناتج: `<العنوان> - <الناشر>.epub`
  - نحافظ على الحروف العربية والمسافات (بدون شرطات سفلية).
  - نحذف بادئة «كتاب/الكتاب» من العنوان.

## الخيارات
- `-o, --output`: مسار الملف الناتج.
- `--throttle <ثوانٍ>`: مهلة بين الطلبات (الافتراضي 0.8). استخدم 0.6–1.0 للحفاظ على الخادم.
- `--limit <N>`: جلب أول N فصل (للاختبار).
- `--cover-auto`: محاولة جلب أول نتيجة من Google Images كغلاف؛ في حال الفشل يُبنى الملف بدون غلاف.

## ما يعمل وما لا يعمل
- يعمل بثبات: EPUB3 «المصغَّر» أعلاه — يمر عبر Send‑to‑Kindle لهذا الكتاب.
- غير موثوق عبر Send‑to‑Kindle (تم استبعاده):
  - EPUB3 مع خطوط مضمّنة أو صفحات إضافية (غلاف/بطاقة) — غالبًا خطأ e999.
  - EPUB2 (OPF 2.0 + NCX) — غير ثابت، e999.
  - DOCX — لم يُقبل في اختباراتنا لهذا العنوان.

## ملاحظات
- احترم الموقع: لا توازِ الطلبات واستخدم مهلة مناسبة.
- عرض RTL يعتمد على القارئ المستخدم.
- إن رُفض الملف من Kindle، جرّب النسخ المباشر عبر USB (بدون تحويل).
