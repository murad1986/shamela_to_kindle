shamela_books — парсер книг и сборщик EPUB (RTL)

[English](README.en.md) | [العربية](README.ar.md) | Русский

Проект для выгрузки книг с сайта `shamela.ws` и сборки из них файлов EPUB/DOCX с корректной поддержкой арабского письма (RTL) и удобной навигацией.

## Структура
- `scripts/shamela_to_epub.py` — основной скрипт (без внешних зависимостей).
- `output/` — готовые файлы (EPUB).

## Быстрый старт
- Python 3.11+: `python3 scripts/shamela_to_epub.py 'https://shamela.ws/book/158' --throttle 0.6`
- С обложкой (Google Images): добавьте `--cover-auto`
- Результат: `output/<Название книги> - <Издатель>.epub`.

## Поддерживаемый формат (один, «рабочий»)
- EPUB3 (минимальный профиль, оптимален для Send‑to‑Kindle):
  - Без обложки и страницы «بطاقة الكتاب».
  - Без встроенных шрифтов.
  - `nav.xhtml` присутствует в манифесте, но не включён в `spine`.

## Ключевые опции
- `-o, --output` — путь к выходному файлу (по умолчанию берётся из названия книги + издатель).
- `--throttle 0.6` — пауза между запросами (сек).
- `--limit N` — ограничить число глав (для тестов).
- `--cover-auto` — попытаться найти обложку через Google Images (берётся первый результат). Если не удалось — файл собирается без обложки.
- `--cover path/to.jpg|png` — задать локальную обложку вручную (рекомендуется ≥ 300×300).

## Обложка и «بطاقة الكتاب»
- По умолчанию обложка не добавляется (для максимальной совместимости). При необходимости:
  - `--cover-auto` — автопоиск обложки (Google Images). Логика и фильтры описаны в TECHNICAL.md.
  - `--cover path/to.jpg|png` — вручную задать файл обложки (рекомендуется ≥ 300×300).

## Что не работало и что работает
- Работает стабильно: EPUB3 (минимальный профиль) — без шрифтов, без обложки/«بطاقة الكتاب», `nav.xhtml` не в `spine`.
- Не работало (на отправке через Send‑to‑Kindle для этой книги):
  - EPUB3 с обложкой/«بطاقة الكتاب» и/или встроенными шрифтами — ошибка e999.
  - EPUB2 (OPF 2.0 + NCX) — нестабильно, e999.
  - DOCX — не принят в тестах.

## Пример
- `python3 scripts/shamela_to_epub.py 'https://shamela.ws/book/158' --throttle 0.6`
